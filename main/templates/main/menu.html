{% extends 'main/base.html' %}
{% load static %}
{% block title %}Menu | Snack Bar{% endblock %}
{% block content %}
{% if messages %}
<ul class="messages">
{% for message in messages %}
<li {% if message.tags %} class="{{ message.tags }}" {% endif %}>{{ message }}</li>
{% endfor %}
</ul>
{% endif %}

<div class="container my-4">
<h1 class="text-center mb-4">Our Menu</h1>

<!-- Biscuits Section -->
<section class="mb-5">
<h2 class="text-center mb-4">Biscuits</h2>
{% if biscuits %}
<div class="row">
{% for item in biscuits %}
<div class="col-6 col-md-3 mb-4">
<div class="card h-100">
{% if item.image %}
    <!-- Extract just the filename from the full path and serve as static file -->
    {% with image_name=item.image.name|cut:'menu_images/' %}
        <img src="{% static 'main/images/' %}{{ image_name }}" class="card-img-top" alt="{{ item.name }}">
    {% endwith %}
{% else %}
    <img src="{% static 'main/images/default.png' %}" class="card-img-top" alt="{{ item.name }}">
{% endif %}
<div class="card-body text-center d-flex flex-column">
<h5 class="card-title">{{ item.name }}</h5>
<p class="card-text">GHS {{ item.price }}</p>
{% if item.description %}
<p class="card-text"><small class="text-muted">{{ item.description }}</small></p>
{% endif %}
<p class="card-text"><small>Available: {{ item.quantity }}</small></p>
{% if item.quantity == 0 %}
<p class="text-danger fw-bold">Out of Stock</p>
{% elif item.quantity < 5 %}
<p class="text-warning fw-bold">Low Stock</p>
{% endif %}
<div class="mt-auto">
<form method="post" action="{% url 'add_to_cart' item.id %}">
{% csrf_token %}
<button type="submit" class="btn btn-primary" {% if item.quantity == 0 %} disabled {% endif %}>
{% if item.quantity == 0 %}
 Out of Stock
{% else %}
 Add to Cart
{% endif %}
</button>
</form>
</div>
</div>
</div>
</div>
{% endfor %}
</div>
{% else %}
<p class="text-center">No biscuits available at the moment.</p>
{% endif %}
</section>

<!-- Drinks Section -->
<section class="mb-5">
<h2 class="text-center mb-4">Drinks</h2>
{% if drinks %}
<div class="row">
{% for item in drinks %}
<div class="col-6 col-md-3 mb-4">
<div class="card h-100">
{% if item.image %}
    <!-- Extract just the filename from the full path and serve as static file -->
    {% with image_name=item.image.name|cut:'menu_images/' %}
        <img src="{% static 'main/images/' %}{{ image_name }}" class="card-img-top" alt="{{ item.name }}">
    {% endwith %}
{% else %}
    <img src="{% static 'main/images/default.png' %}" class="card-img-top" alt="{{ item.name }}">
{% endif %}
<div class="card-body text-center d-flex flex-column">
<h5 class="card-title">{{ item.name }}</h5>
<p class="card-text">GHS {{ item.price }}</p>
{% if item.description %}
<p class="card-text"><small class="text-muted">{{ item.description }}</small></p>
{% endif %}
<p class="card-text"><small>Available: {{ item.quantity }}</small></p>
{% if item.quantity == 0 %}
<p class="text-danger fw-bold">Out of Stock</p>
{% elif item.quantity < 5 %}
<p class="text-warning fw-bold">Low Stock</p>
{% endif %}
<div class="mt-auto">
<form method="post" action="{% url 'add_to_cart' item.id %}">
{% csrf_token %}
<button type="submit" class="btn btn-primary" {% if item.quantity == 0 %} disabled {% endif %}>
{% if item.quantity == 0 %}
 Out of Stock
{% else %}
 Add to Cart
{% endif %}
</button>
</form>
</div>
</div>
</div>
</div>
{% endfor %}
</div>
{% else %}
<p class="text-center">No drinks available at the moment.</p>
{% endif %}
</section>
</div>
{% endblock %}